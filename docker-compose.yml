# This file is part of AsicVerifier and is released under
# the AGPL-3.0-only License: https://opensource.org/license/agpl-v3/

version: '3.7'
services:
  cache:
    build:
      context: .
      target: cache
      platforms:
        - linux/amd64
      no_cache: true
    image: pipinfitriadi/asicverifier:cache
  asicverifier:
    build:
      context: .
      platforms:
        - linux/amd64
      cache_from:
        - pipinfitriadi/asicverifier:cache
        - type=registry,ref=pipinfitriadi/asicverifier
        - type=registry,ref=niis/xroad-security-server-sidecar:7.0.4
        - type=registry,ref=eclipse-temurin:8-alpine
      cache_to:
        - type=inline
    image: pipinfitriadi/asicverifier
    platform: linux/amd64
    stdin_open: true
    tty: true
    entrypoint: sh
